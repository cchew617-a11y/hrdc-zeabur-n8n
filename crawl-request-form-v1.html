<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jason Chew's AI Classroom - Secure Scraper</title>
    <style>
        :root { --primary: #ff6d5a; --accent: #4dabf7; --dark: #333; --success: #0ca678; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; justify-content: center; padding: 40px 20px; background: #f0f2f5; color: var(--dark); }
        
        .card { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); width: 100%; max-width: 450px; text-align: center; }
        
        /* Logo & Header */
        .header { margin-bottom: 25px; }
        .logo { width: 80px; height: 80px; border-radius: 50%; border: 3px solid var(--primary); margin-bottom: 10px; object-fit: cover; }
        .company-name { font-size: 1.4rem; font-weight: bold; color: var(--dark); margin: 0; }

        /* Form Elements */
        p { font-size: 0.95rem; color: #666; margin-bottom: 20px; }
        label { display: block; text-align: left; font-size: 0.85rem; font-weight: bold; margin-bottom: 5px; color: #555; }
        input { width: 100%; padding: 12px; margin-bottom: 15px; border: 2px solid #eee; border-radius: 8px; box-sizing: border-box; font-size: 1rem; transition: border 0.3s; }
        input:focus { border-color: var(--primary); outline: none; }

        /* Button */
        .btn { width: 100%; padding: 14px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1.1rem; transition: all 0.2s; color: white; background: var(--primary); }
        .btn:hover { opacity: 0.9; }
        .btn:active { transform: scale(0.98); }
        .btn:disabled { background: #ccc; cursor: not-allowed; }

        /* Notifications */
        #status { font-size: 0.9rem; padding: 15px; border-radius: 8px; margin-top: 20px; display: none; line-height: 1.4; }
        .success { display: block !important; background: #e6fcf5; color: var(--success); border: 1px solid #b2f2bb; text-align: left; }
        .error { display: block !important; background: #fff5f5; color: #fa5252; border: 1px solid #ffc9c9; }

        /* Footer */
        .footer { margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; }
        .admin-email { font-size: 0.9rem; font-weight: bold; color: var(--dark); margin-bottom: 5px; }
        .disclaimer { font-size: 0.75rem; color: #999; line-height: 1.4; }
    </style>
</head>
<body>

    <div class="card">
        <!-- (1) Company Name & Logo -->
        <div class="header">
            <img src="jasonchew.aitrainerlogo.png" alt="Logo" class="logo" onerror="this.src='https://via.placeholder.com/80?text=AI'">
            <div class="company-name">Jason Chew's AI Classroom</div>
        </div>

        <h3>Secure Scraper (v1)</h3>
        <p>Convert any sitemap into a structured AI Knowledge Base delivered to your inbox.</p>
        
        <label for="sitemapUrl">Sitemap URL</label>
        <input type="url" id="sitemapUrl" placeholder="https://site.com/sitemap.xml" required>

        <label for="userEmail">Delivery Email</label>
        <input type="email" id="userEmail" placeholder="your@email.com" required>

        <!-- (2) Start Scraper Button -->
        <button id="scrapeBtn" class="btn" onclick="sendData()">Start Scrape & Email Me</button>

        <!-- (3) Notification Message -->
        <div id="status"></div>

        <div class="footer">
            <!-- (4) Admin Email -->
            <div class="admin-email">JasonChew.HRDCtrainer@gmail.com</div>
            <!-- (5) Disclaimer -->
            <div class="disclaimer">
                <b>Privacy Note:</b> Your data is private. Results are generated as individual Google Docs and emailed only to the address provided. System clears cache every 24 hours.
            </div>
        </div>
    </div>

    <script>
        async function sendData() {
            const urlInput = document.getElementById('sitemapUrl');
            const emailInput = document.getElementById('userEmail');
            const status = document.getElementById('status');
            const btn = document.getElementById('scrapeBtn');
            
            // Replace with your n8n Production Webhook URL
            const webhookUrl = 'https://n8ncchew617.zeabur.app/webhook/crawl-request';

            if (!urlInput.value || !emailInput.value) {
                return alert('Please fill in both the Sitemap URL and your Email.');
            }

            // UI Feedback
            status.className = ""; 
            status.innerText = "⏳ Sending request to AI engine...";
            status.style.display = "block";
            btn.disabled = true;
            
            try {
                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        sitemapUrl: urlInput.value,
                        userEmail: emailInput.value 
                    })
                });

                if (response.ok) {
                    status.className = "success";
                    status.innerHTML = `<b>✔ Request Successful!</b><br><br>The AI is now crawling the site. Since this processes multiple pages, it usually takes <b>3 to 5 minutes</b>. Please check your inbox (<b>${emailInput.value}</b>) shortly for the links!`;
                    urlInput.value = ""; // Clear input on success
                } else {
                    throw new Error("Server error " + response.status);
                }
            } catch (error) {
                status.className = "error";
                status.innerText = "✖ Failure: System offline. Please contact the administrator.";
            } finally {
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
